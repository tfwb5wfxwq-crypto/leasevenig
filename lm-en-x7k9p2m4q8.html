<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cover Letter - Lea Sevenig</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --cream: #FAF8F5;
      --charcoal: #2C2C2C;
      --gold: #C9A962;
      --gold-light: #D4BC7B;
      --gray: #6B6B6B;
      --light-gray: #E8E4DF;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    @page { size: A4; margin: 0; }

    body {
      font-family: 'Montserrat', sans-serif;
      background: #e0e0e0;
      color: var(--charcoal);
      line-height: 1.7;
      font-size: 11pt;
      padding: 20px;
    }

    .toolbar {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 10px;
      z-index: 1000;
    }

    .toolbar button {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn-save { background: var(--gold); color: white; }
    .btn-save:hover { background: var(--gold-light); transform: translateY(-2px); }

    .btn-reset {
      background: white;
      color: var(--gray);
      border: 1px solid var(--light-gray) !important;
    }
    .btn-reset:hover { color: var(--gold); border-color: var(--gold) !important; }

    .lang-switch {
      display: flex;
      gap: 5px;
      background: white;
      padding: 4px;
      border-radius: 8px;
    }

    .lang-btn {
      padding: 8px 12px;
      border-radius: 6px;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 600;
      text-decoration: none;
      color: var(--gray);
      transition: all 0.3s ease;
    }

    .lang-btn:hover { color: var(--gold); }
    .lang-btn.active { background: var(--gold); color: white; }

    /* Page transition */
    body {
      opacity: 1;
      transition: opacity 0.3s ease;
    }
    body.fade-out {
      opacity: 0;
    }

    .controls {
      max-width: 210mm;
      margin: 0 auto 20px;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .controls-row {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .controls-row:last-child { margin-bottom: 0; }

    .controls label {
      font-size: 11px;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 1px;
      min-width: 80px;
    }

    .controls input {
      flex: 1;
      border: none;
      border-bottom: 1px solid var(--light-gray);
      padding: 8px 0;
      font-family: 'Montserrat', sans-serif;
      font-size: 12px;
      outline: none;
    }

    .controls input:focus { border-color: var(--gold); }

    .profile-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .profile-btn {
      padding: 10px 16px;
      border: 2px solid var(--light-gray);
      border-radius: 25px;
      background: white;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      color: var(--gray);
    }

    .profile-btn:hover {
      border-color: var(--gold);
      color: var(--gold);
    }

    .profile-btn.active {
      background: var(--gold);
      border-color: var(--gold);
      color: white;
    }

    .page {
      width: 210mm;
      min-height: 297mm;
      padding: 25mm 25mm 20mm 25mm;
      margin: 0 auto;
      background: var(--cream);
      position: relative;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
    }

    .date {
      text-align: right;
      font-size: 10pt;
      color: var(--gray);
      margin-bottom: 12px;
      font-style: italic;
    }

    .header {
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--gold);
    }

    .name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 24pt;
      font-weight: 500;
      letter-spacing: 3px;
      color: var(--charcoal);
      margin-bottom: 5px;
    }

    .contact-info {
      font-size: 9pt;
      color: var(--gray);
      letter-spacing: 1px;
    }

    .contact-info a { color: var(--gold); text-decoration: none; }

    .subject {
      margin-bottom: 15px;
      padding: 8px 0;
      border-top: 1px solid var(--light-gray);
      border-bottom: 1px solid var(--light-gray);
    }

    .subject-label {
      font-weight: 600;
      color: var(--gold);
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 8pt;
    }

    .subject p {
      font-family: 'Cormorant Garamond', serif;
      font-size: 11pt;
      font-style: italic;
      margin-top: 3px;
    }

    .salutation { margin-bottom: 12px; font-weight: 500; font-size: 9.5pt; }

    .body p {
      margin-bottom: 10px;
      text-align: justify;
      font-size: 9pt;
      line-height: 1.55;
    }

    .closing { margin-top: 15px; }
    .closing p { margin-bottom: 3px; font-size: 9pt; line-height: 1.55; }

    .signature {
      margin-top: 15px;
      font-family: 'Cormorant Garamond', serif;
      font-size: 13pt;
      font-style: italic;
    }

    .footer {
      position: absolute;
      bottom: 12mm;
      left: 25mm;
      right: 25mm;
      text-align: center;
      padding-top: 8px;
      border-top: 1px solid var(--light-gray);
    }

    .footer p { font-size: 8pt; color: var(--gray); letter-spacing: 1px; }
    .footer a { color: var(--gold); text-decoration: none; }

    /* Editable zones */
    [contenteditable="true"] {
      outline: none;
      border-radius: 4px;
      transition: box-shadow 0.2s ease;
    }
    [contenteditable="true"]:hover {
      box-shadow: inset 0 0 0 1px rgba(201, 169, 98, 0.2);
    }
    [contenteditable="true"]:focus {
      box-shadow: inset 0 0 0 1.5px rgba(201, 169, 98, 0.4);
    }

    /* Floating format toolbar */
    .format-toolbar {
      position: absolute;
      display: none;
      background: var(--charcoal);
      border-radius: 8px;
      padding: 4px;
      gap: 2px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.25);
      z-index: 2000;
    }
    .format-toolbar.visible { display: flex; }
    .format-toolbar button {
      width: 36px;
      height: 36px;
      border: none;
      border-radius: 6px;
      background: transparent;
      color: white;
      font-family: 'Cormorant Garamond', serif;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s;
    }
    .format-toolbar button:hover { background: rgba(255,255,255,0.15); }
    .format-toolbar button.active { background: var(--gold); }
    .format-toolbar button.fmt-bold { font-weight: 700; font-family: 'Montserrat', sans-serif; font-size: 14px; }
    .format-toolbar button.fmt-italic { font-style: italic; }
    .format-toolbar button.fmt-underline { text-decoration: underline; }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--charcoal);
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 500;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s ease;
      z-index: 3000;
      pointer-events: none;
    }
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    @media print {
      body { background: white; padding: 0; margin: 0; }
      .toolbar, .controls, .format-toolbar, .toast { display: none !important; }
      [contenteditable="true"]:hover,
      [contenteditable="true"]:focus { box-shadow: none; }
      .page {
        width: 100%;
        padding: 20mm 22mm 18mm 22mm;
        box-shadow: none;
        min-height: auto;
      }
      .body p { font-size: 9pt; line-height: 1.5; margin-bottom: 8px; }
      .footer {
        position: relative;
        bottom: auto;
        left: auto;
        right: auto;
        margin-top: 20px;
      }
    }

    @media (max-width: 800px) {
      body { padding: 10px; }
      .page { width: 100%; padding: 20px; min-height: auto; }
      .toolbar { position: static; justify-content: center; margin-bottom: 15px; flex-wrap: wrap; }
      .controls { padding: 15px; }
      .controls-row { flex-direction: column; align-items: stretch; }
      .name { font-size: 20pt; }
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <div class="lang-switch">
      <a href="lm-x7k9p2m4q8.html" class="lang-btn" onclick="switchLang(event)">FR</a>
      <span class="lang-btn active">EN</span>
    </div>
    <button class="btn-reset" onclick="resetTemplate()">Reset text</button>
    <button class="btn-save" onclick="window.print()">Save as PDF</button>
  </div>

  <div class="controls">
    <div class="controls-row">
      <label>Profile</label>
      <div class="profile-buttons">
        <button class="profile-btn active" onclick="setProfile('general')">General</button>
        <button class="profile-btn" onclick="setProfile('marketing')">Marketing</button>
        <button class="profile-btn" onclick="setProfile('event')">Events</button>
        <button class="profile-btn" onclick="setProfile('hospitality')">Luxury Hospitality</button>
        <button class="profile-btn" onclick="setProfile('communication')">Communications</button>
        <button class="profile-btn" onclick="setProfile('audiovisual')">Audiovisual</button>
      </div>
    </div>
    <div class="controls-row">
      <label>Company</label>
      <input type="text" id="companyName" placeholder="Optional – e.g. Paperjam" oninput="updateCompany()">
    </div>
    <div class="controls-row">
      <label>Subject</label>
      <input type="text" id="subjectInput" placeholder="e.g. Marketing Project Manager" oninput="updateSubject()">
    </div>
  </div>

  <div class="page">
    <p class="date" id="currentDate"></p>

    <header class="header">
      <h1 class="name">LEA SEVENIG</h1>
      <p class="contact-info">Paris, France · +33 6 64 32 20 24 · leasevenig13@icloud.com</p>
      <p class="contact-info" style="margin-top: 4px;">
        <a href="https://leasevenig.cv" style="font-weight: 500;">leasevenig.cv</a>
      </p>
    </header>

    <div class="subject">
      <span class="subject-label">Subject</span>
      <p><span id="subjectDisplay">Application</span><span id="companyDisplay"></span></p>
    </div>

    <p class="salutation">Dear Sir or Madam,</p>

    <div class="body" id="letterBody" contenteditable="true"></div>

    <div class="closing" contenteditable="true">
      <p>I would be delighted to discuss my background and motivation in more detail during an interview.</p>
      <p>Thank you for considering my application. I look forward to hearing from you.</p>
      <p class="signature">Lea Sevenig</p>
    </div>

    <footer class="footer">
      <p>Portfolio: <a href="https://leasevenig.cv">leasevenig.cv</a></p>
    </footer>
  </div>

  <!-- Floating format toolbar -->
  <div class="format-toolbar" id="formatToolbar">
    <button class="fmt-bold" onmousedown="formatText(event, 'bold')" title="Bold">B</button>
    <button class="fmt-italic" onmousedown="formatText(event, 'italic')" title="Italic">I</button>
    <button class="fmt-underline" onmousedown="formatText(event, 'underline')" title="Underline">U</button>
  </div>

  <!-- Toast notification -->
  <div class="toast" id="toast">Saved</div>

  <script>
    const profiles = {
      general: {
        subject: "Application",
        body: `<p>Three mother tongues, a pop-up restaurant built from scratch, a Master's in audiovisual production, and 18 months running marketing for five Parisian venues at once. That's the short version. Here's the rest.</p>

<p>I started with a Bachelor's in International Restaurant Management at Institut Lyfe in Lyon. Not a lecture-hall degree — we were in kitchens, dining rooms, dealing with real customers. That's where I learned how a business actually works from the inside: margins, flow, the experience you sell without naming it.</p>

<p>In 2022, with two partners, I launched Focacc' — a pop-up focaccia restaurant in Lyon, six months of operation. I handled everything brand-related: the name, the visual identity, the Instagram strategy that got us to 1,200 followers in three weeks. We ended up at 85% occupancy over the last two months. The biggest takeaway: learn to execute fast, measure, and adjust.</p>

<p>After that, I joined EFAP Paris for a Master's in Communication and Audiovisual Production. Alongside my studies, I worked on the "Court ou Crève" masterclass with YouTuber Ludovic — viral video, Instagram launch, website design. A project that forced me to juggle production, tight deadlines, and a demanding audience.</p>

<p>Out of the Master's, I joined the Nasther Group as Communications Manager, Graphic Designer, and Web Designer. Five Parisian establishments, each with its own positioning. I managed it all: brand guidelines, social media, print campaigns, website redesigns. The most valuable part was learning to switch between completely different brand universes in the same day.</p>

<p>I'm Luxembourgish — I speak Luxembourgish, French, German, and English fluently. I work with the Adobe suite, Figma, Canva, and I'm comfortable with standard analytics and CMS tools.</p>

<p>What I'm looking for now: a team where I can bring this mix of strategy and hands-on execution, and keep growing on ambitious projects.</p>`
      },
      marketing: {
        subject: "Application - Marketing",
        body: `<p>Good marketing starts on the ground. Before thinking about funnels or KPIs, I first learned to notice what makes a customer come back — or not. That hands-on instinct is what I bring to every project.</p>

<p>My path started at Institut Lyfe in Lyon, with a Bachelor's in International Restaurant Management. Three years understanding business mechanics from the inside — pricing, positioning, customer journeys. Not from a slide deck: from a kitchen, a dining room, a counter.</p>

<p>In 2022, I co-founded Focacc', a pop-up restaurant in Lyon. Six months, from concept to close. I ran all the acquisition work: brand identity, social media strategy, local partnerships. Result: 1,200 Instagram followers in three weeks, 85% occupancy by the end. That kind of constraint — tight budget, limited time — is the best marketing training there is.</p>

<p>I then completed a Master's in Communication and Audiovisual Production at EFAP Paris. A program that gave me the technical toolkit for content: editing, art direction, visual storytelling. Not just the theory — the ability to produce.</p>

<p>At Nasther, for a year and a half, I managed marketing for five Parisian establishments. In practice: defining communication axes per brand, community management, creating every print and digital asset, tracking performance, coordinating with on-site teams. The daily challenge was maintaining brand consistency while adapting the message to very different audiences — from a bistro to a high-end cocktail bar.</p>

<p>Now, I want to join an organization where marketing has real, measurable impact. My profile blends strategic thinking with fast execution — and that combination is exactly what moves projects forward.</p>`
      },
      event: {
        subject: "Application - Events",
        body: `<p>My first real event was a 40-seat pop-up restaurant in Lyon. Not an internship — I built the whole thing: the concept, the venue, the team, the communications. Six months of operation, from opening night to closing. That kind of fieldwork is what shaped my approach to events.</p>

<p>The project, Focacc', I co-founded in 2022 during my Bachelor's at Institut Lyfe. I learned everything a classroom can't teach: negotiating a short-term lease, managing supplier surprises, pivoting the concept mid-run when the numbers weren't right. Opening night, we had 15 reservations. The last month, we were turning people away.</p>

<p>I then worked for a year at La Dimanche, one of Paris's best-known LGBTQ+ parties. I was in charge of bar logistics: ordering, stock management, flow optimization during events. Crowds of 800 to 1,000, with surges to manage in real time. It builds composure.</p>

<p>Alongside my Master's at EFAP, I collaborated on the "Court ou Crève" masterclass with YouTuber Ludovic. Main video production, Instagram account launch, website creation. A digital event format — with the same demands for deadlines, team coordination, and results.</p>

<p>At Nasther, I supported numerous events across the group's five venues: launch nights, brand collaborations, private events. My role: coordinating between teams, producing all communication materials, handling operational follow-through on the day.</p>

<p>What I know how to do: turn a concept into a real experience, on time, on budget, without it showing when things get tight. That's the skill set I'd like to bring to your event projects.</p>`
      },
      hospitality: {
        subject: "Application - Luxury Hospitality",
        body: `<p>I grew up in Luxembourg, between three languages and three cultures. That habit of reading the room — knowing when to be formal, when to be warm, when to simply listen — is exactly what luxury hospitality demands.</p>

<p>My training at Institut Lyfe in Lyon focused on international restaurant management. Three years immersed in service standards, venue management, and the attention to detail that separates a good meal from a memorable experience. That's where I developed a feel for luxury — not the flashy kind, but the right gesture at the right moment.</p>

<p>With Focacc', the pop-up restaurant I co-founded in Lyon, I came to understand the power of perceived value. We were selling focaccias, but what customers were buying was the atmosphere, the care in every detail — from the menu typography to the packaging. When your budget is tight, you learn to create perceived quality differently. That discipline has stayed with me.</p>

<p>My Master's in Communication and Audiovisual Production at EFAP gave me the tools to translate a brand identity into images, words, and a coherent digital experience. Everything that makes a guest discover a hotel online and already want to be there.</p>

<p>At Nasther, I led marketing for five Parisian venues — some of them high-end. Creating the visual universe, managing social media with a curated editorial line, designing print materials. The challenge: maintaining a consistent level of quality at every client touchpoint.</p>

<p>I speak Luxembourgish, French, German, and English — all fluently. That's a real advantage for welcoming international guests and adapting communications to different markets. I'd love to bring this combination — service instinct, visual culture, multilingualism — to an exceptional property.</p>`
      },
      communication: {
        subject: "Application - Communications",
        body: `<p>When a brand communicates well, you don't notice. Everything feels natural, obvious, effortless. It's when things go wrong that people notice the communications. My job is to make sure nobody ever does — that the message lands without any visible effort.</p>

<p>I studied communications through two paths. First through the field: a Bachelor's in Restaurant Management at Institut Lyfe, where I saw firsthand how a venue's messaging directly shapes customer perception. Then through craft: a Master's in Communication and Audiovisual Production at EFAP Paris — editorial strategy, art direction, content production, project management.</p>

<p>Between the two, I co-founded Focacc' in Lyon. A pop-up restaurant where I built the entire communications from zero: naming, visual identity, Instagram editorial line, print materials. With virtually no budget, every word choice, every photograph mattered. We reached 1,200 followers in three weeks — proof that a clear, authentic message is enough when it's properly calibrated.</p>

<p>The "Court ou Crève" masterclass, created with YouTuber Ludovic, confronted me with a different register: mass-audience digital communications. Viral video, community management, website — all with tight deadlines and an audience that doesn't forgive missteps.</p>

<p>At Nasther, I was Head of Communications for five establishments. Not five variations of the same message — five distinct identities, five tones, five audiences. I managed content strategy, community management, graphic assets, websites. The biggest lesson: learning to arbitrate between what the brand wants to say and what the audience needs to hear.</p>

<p>I'm looking for an organization that treats communications as a strategic lever, not a cost center. That's the kind of environment where I do my best work.</p>`
      },
      audiovisual: {
        subject: "Application - Audiovisual",
        body: `<p>I've been making images since I first got a computer. First out of curiosity, then through training, now as a profession. What sets me apart from a purely creative profile is that I understand why we produce — not just how.</p>

<p>My Bachelor's at Institut Lyfe gave me a solid business foundation: understanding a market, a positioning, a target audience. My Master's in Communication and Audiovisual Production at EFAP added the technical layer: directing, editing, motion design, art direction, production management.</p>

<p>The project that connected everything was the "Court ou Crève" masterclass with YouTuber Ludovic. I co-produced the main video — from script to final cut. I also launched and managed the project's Instagram account and designed the website. It was my first end-to-end audiovisual project with a real audience and concrete visibility targets.</p>

<p>At Nasther, I was responsible for all visual production across five establishments: photo shoots, graphic creation (menus, posters, social media), website design, and a few short video projects for social channels. I worked solo on these — which means I managed everything from brief to delivery, including feedback rounds and revisions.</p>

<p>As a freelancer, I also help restaurateurs with their visual identity: logos, brand guidelines, social media templates, photo and video project oversight. Projects where you need to quickly grasp the client's universe and produce assets that actually feel like them — not a generic template.</p>

<p>My technical environment: Premiere Pro, After Effects, Photoshop, Illustrator, InDesign, Lightroom, Figma, Canva, Webflow, WordPress. I'm comfortable across the full chain, from capture to final deliverable.</p>

<p>What I'm looking for: a team where audiovisual and visual production has genuine strategic weight. Where content isn't just made to fill a feed, but to tell a story.</p>`
      }
    };

    let currentProfile = 'general';
    let saveTimeout = null;

    // --- LocalStorage ---
    function getStorageKey(profile) {
      return `lm_edited_en_${profile}`;
    }

    function getClosingKey(profile) {
      return `lm_edited_en_closing_${profile}`;
    }

    function saveToStorage() {
      clearTimeout(saveTimeout);
      saveTimeout = setTimeout(() => {
        const bodyHtml = document.getElementById('letterBody').innerHTML;
        const closingHtml = document.querySelector('.closing').innerHTML;
        localStorage.setItem(getStorageKey(currentProfile), bodyHtml);
        localStorage.setItem(getClosingKey(currentProfile), closingHtml);
        showToast();
      }, 1000);
    }

    function showToast() {
      const toast = document.getElementById('toast');
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 1500);
    }

    function resetTemplate() {
      if (!confirm('Reset to original text? Your changes will be lost.')) return;
      localStorage.removeItem(getStorageKey(currentProfile));
      localStorage.removeItem(getClosingKey(currentProfile));
      document.getElementById('letterBody').innerHTML = profiles[currentProfile].body;
      document.querySelector('.closing').innerHTML = getDefaultClosing();
      showToast();
    }

    function getDefaultClosing() {
      return `<p>I would be delighted to discuss my background and motivation in more detail during an interview.</p>
      <p>Thank you for considering my application. I look forward to hearing from you.</p>
      <p class="signature">Lea Sevenig</p>`;
    }

    // --- Profile switching ---
    function setProfile(profile) {
      currentProfile = profile;
      document.querySelectorAll('.profile-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');

      const p = profiles[profile];
      document.getElementById('subjectInput').value = p.subject;
      document.getElementById('subjectDisplay').textContent = p.subject;

      // Load from localStorage or fallback to template
      const savedBody = localStorage.getItem(getStorageKey(profile));
      const savedClosing = localStorage.getItem(getClosingKey(profile));
      document.getElementById('letterBody').innerHTML = savedBody || p.body;
      if (savedClosing) {
        document.querySelector('.closing').innerHTML = savedClosing;
      } else {
        document.querySelector('.closing').innerHTML = getDefaultClosing();
      }
    }

    function updateSubject() {
      const subject = document.getElementById('subjectInput').value.trim();
      document.getElementById('subjectDisplay').textContent = subject || profiles[currentProfile].subject;
    }

    function updateCompany() {
      const company = document.getElementById('companyName').value.trim();
      document.getElementById('companyDisplay').textContent = company ? ` - ${company}` : '';
    }

    function updateDate() {
      const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
      const now = new Date();
      document.getElementById('currentDate').textContent = `Paris, ${months[now.getMonth()]} ${now.getDate()}, ${now.getFullYear()}`;
    }

    // --- Paste handler: plain text only ---
    document.addEventListener('paste', function(e) {
      const target = e.target.closest('[contenteditable="true"]');
      if (!target) return;
      e.preventDefault();
      const text = e.clipboardData.getData('text/plain');
      document.execCommand('insertText', false, text);
    });

    // --- Auto-save on input ---
    document.addEventListener('input', function(e) {
      if (e.target.closest('[contenteditable="true"]')) {
        saveToStorage();
      }
    });

    // --- Floating format toolbar ---
    const toolbar = document.getElementById('formatToolbar');

    function formatText(e, command) {
      e.preventDefault();
      document.execCommand(command, false, null);
      updateToolbarState();
    }

    function updateToolbarState() {
      toolbar.querySelector('.fmt-bold').classList.toggle('active', document.queryCommandState('bold'));
      toolbar.querySelector('.fmt-italic').classList.toggle('active', document.queryCommandState('italic'));
      toolbar.querySelector('.fmt-underline').classList.toggle('active', document.queryCommandState('underline'));
    }

    function showToolbar() {
      const sel = window.getSelection();
      if (!sel.rangeCount || sel.isCollapsed) {
        toolbar.classList.remove('visible');
        return;
      }
      const range = sel.getRangeAt(0);
      const container = range.commonAncestorContainer;
      const editable = (container.nodeType === 1 ? container : container.parentElement).closest('[contenteditable="true"]');
      if (!editable) {
        toolbar.classList.remove('visible');
        return;
      }

      const rect = range.getBoundingClientRect();
      const toolbarWidth = 116;
      let left = rect.left + (rect.width / 2) - (toolbarWidth / 2) + window.scrollX;
      let top = rect.top - 48 + window.scrollY;

      // Keep within viewport
      left = Math.max(8, Math.min(left, window.innerWidth - toolbarWidth - 8));
      if (top < 8) top = rect.bottom + 8 + window.scrollY;

      toolbar.style.left = left + 'px';
      toolbar.style.top = top + 'px';
      toolbar.classList.add('visible');
      updateToolbarState();
    }

    document.addEventListener('selectionchange', showToolbar);
    document.addEventListener('mousedown', function(e) {
      if (!e.target.closest('.format-toolbar') && !e.target.closest('[contenteditable="true"]')) {
        toolbar.classList.remove('visible');
      }
    });

    // --- Init ---
    updateDate();
    const urlParams = new URLSearchParams(window.location.search);
    const paramCompany = urlParams.get('company');
    const paramSubject = urlParams.get('subject');
    const paramProfile = urlParams.get('profile');

    if (paramProfile && profiles[paramProfile]) {
      currentProfile = paramProfile;
      document.querySelectorAll('.profile-btn').forEach(btn => {
        btn.classList.toggle('active', btn.textContent.toLowerCase().includes(paramProfile.substring(0, 4)));
      });
      const savedBody = localStorage.getItem(getStorageKey(paramProfile));
      document.getElementById('letterBody').innerHTML = savedBody || profiles[paramProfile].body;
      const savedClosing = localStorage.getItem(getClosingKey(paramProfile));
      if (savedClosing) document.querySelector('.closing').innerHTML = savedClosing;
      document.getElementById('subjectInput').value = paramSubject || profiles[paramProfile].subject;
      document.getElementById('subjectDisplay').textContent = paramSubject || profiles[paramProfile].subject;
    } else {
      document.getElementById('subjectInput').value = paramSubject || profiles.general.subject;
      document.getElementById('subjectDisplay').textContent = paramSubject || profiles.general.subject;
      const savedBody = localStorage.getItem(getStorageKey('general'));
      document.getElementById('letterBody').innerHTML = savedBody || profiles.general.body;
      const savedClosing = localStorage.getItem(getClosingKey('general'));
      if (savedClosing) document.querySelector('.closing').innerHTML = savedClosing;
    }

    if (paramCompany) {
      document.getElementById('companyName').value = paramCompany;
      document.getElementById('companyDisplay').textContent = ` - ${paramCompany}`;
    }

    // Smooth language switch
    function switchLang(e) {
      e.preventDefault();
      const href = e.target.getAttribute('href');
      document.body.classList.add('fade-out');
      setTimeout(() => {
        window.location.href = href;
      }, 300);
    }
  </script>
</body>
</html>
