<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lettre de motivation - Lea Sevenig</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --cream: #FAF8F5;
      --charcoal: #2C2C2C;
      --gold: #C9A962;
      --gold-light: #D4BC7B;
      --gray: #6B6B6B;
      --light-gray: #E8E4DF;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    @page { size: A4; margin: 0; }

    body {
      font-family: 'Montserrat', sans-serif;
      background: #e0e0e0;
      color: var(--charcoal);
      line-height: 1.7;
      font-size: 11pt;
      padding: 20px;
    }

    .toolbar {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 10px;
      z-index: 1000;
    }

    .toolbar button {
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn-save { background: var(--gold); color: white; }
    .btn-save:hover { background: var(--gold-light); transform: translateY(-2px); }

    .btn-reset {
      background: white;
      color: var(--gray);
      border: 1px solid var(--light-gray) !important;
    }
    .btn-reset:hover { color: var(--gold); border-color: var(--gold) !important; }

    .lang-switch {
      display: flex;
      gap: 5px;
      background: white;
      padding: 4px;
      border-radius: 8px;
    }

    .lang-btn {
      padding: 8px 12px;
      border-radius: 6px;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 600;
      text-decoration: none;
      color: var(--gray);
      transition: all 0.3s ease;
    }

    .lang-btn:hover { color: var(--gold); }
    .lang-btn.active { background: var(--gold); color: white; }

    /* Page transition */
    body {
      opacity: 1;
      transition: opacity 0.3s ease;
    }
    body.fade-out {
      opacity: 0;
    }

    .controls {
      max-width: 210mm;
      margin: 0 auto 20px;
      padding: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    .controls-row {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .controls-row:last-child { margin-bottom: 0; }

    .controls label {
      font-size: 11px;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 1px;
      min-width: 80px;
    }

    .controls input {
      flex: 1;
      border: none;
      border-bottom: 1px solid var(--light-gray);
      padding: 8px 0;
      font-family: 'Montserrat', sans-serif;
      font-size: 12px;
      outline: none;
    }

    .controls input:focus { border-color: var(--gold); }

    .profile-buttons {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .profile-btn {
      padding: 10px 16px;
      border: 2px solid var(--light-gray);
      border-radius: 25px;
      background: white;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      color: var(--gray);
    }

    .profile-btn:hover {
      border-color: var(--gold);
      color: var(--gold);
    }

    .profile-btn.active {
      background: var(--gold);
      border-color: var(--gold);
      color: white;
    }

    .page {
      width: 210mm;
      min-height: 297mm;
      padding: 25mm 25mm 20mm 25mm;
      margin: 0 auto;
      background: var(--cream);
      position: relative;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
    }

    .date {
      text-align: right;
      font-size: 10pt;
      color: var(--gray);
      margin-bottom: 12px;
      font-style: italic;
    }

    .header {
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--gold);
    }

    .name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 24pt;
      font-weight: 500;
      letter-spacing: 3px;
      color: var(--charcoal);
      margin-bottom: 5px;
    }

    .contact-info {
      font-size: 9pt;
      color: var(--gray);
      letter-spacing: 1px;
    }

    .contact-info a { color: var(--gold); text-decoration: none; }

    .subject {
      margin-bottom: 15px;
      padding: 8px 0;
      border-top: 1px solid var(--light-gray);
      border-bottom: 1px solid var(--light-gray);
    }

    .subject-label {
      font-weight: 600;
      color: var(--gold);
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 8pt;
    }

    .subject p {
      font-family: 'Cormorant Garamond', serif;
      font-size: 11pt;
      font-style: italic;
      margin-top: 3px;
    }

    .salutation { margin-bottom: 12px; font-weight: 500; font-size: 9.5pt; }

    .body p {
      margin-bottom: 10px;
      text-align: justify;
      font-size: 9pt;
      line-height: 1.55;
    }

    .closing { margin-top: 15px; }
    .closing p { margin-bottom: 3px; font-size: 9pt; line-height: 1.55; }

    .signature {
      margin-top: 15px;
      font-family: 'Cormorant Garamond', serif;
      font-size: 13pt;
      font-style: italic;
    }

    .footer {
      position: absolute;
      bottom: 12mm;
      left: 25mm;
      right: 25mm;
      text-align: center;
      padding-top: 8px;
      border-top: 1px solid var(--light-gray);
    }

    .footer p { font-size: 8pt; color: var(--gray); letter-spacing: 1px; }
    .footer a { color: var(--gold); text-decoration: none; }

    /* Editable zones */
    [contenteditable="true"] {
      outline: none;
      border-radius: 4px;
      transition: box-shadow 0.2s ease;
    }
    [contenteditable="true"]:hover {
      box-shadow: inset 0 0 0 1px rgba(201, 169, 98, 0.2);
    }
    [contenteditable="true"]:focus {
      box-shadow: inset 0 0 0 1.5px rgba(201, 169, 98, 0.4);
    }

    /* Floating format toolbar */
    .format-toolbar {
      position: absolute;
      display: none;
      background: var(--charcoal);
      border-radius: 8px;
      padding: 4px;
      gap: 2px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.25);
      z-index: 2000;
    }
    .format-toolbar.visible { display: flex; }
    .format-toolbar button {
      width: 36px;
      height: 36px;
      border: none;
      border-radius: 6px;
      background: transparent;
      color: white;
      font-family: 'Cormorant Garamond', serif;
      font-size: 16px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s;
    }
    .format-toolbar button:hover { background: rgba(255,255,255,0.15); }
    .format-toolbar button.active { background: var(--gold); }
    .format-toolbar button.fmt-bold { font-weight: 700; font-family: 'Montserrat', sans-serif; font-size: 14px; }
    .format-toolbar button.fmt-italic { font-style: italic; }
    .format-toolbar button.fmt-underline { text-decoration: underline; }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--charcoal);
      color: white;
      padding: 10px 20px;
      border-radius: 8px;
      font-family: 'Montserrat', sans-serif;
      font-size: 11px;
      font-weight: 500;
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.3s ease;
      z-index: 3000;
      pointer-events: none;
    }
    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    @media print {
      body { background: white; padding: 0; margin: 0; }
      .toolbar, .controls, .format-toolbar, .toast { display: none !important; }
      [contenteditable="true"]:hover,
      [contenteditable="true"]:focus { box-shadow: none; }
      .page {
        width: 100%;
        padding: 20mm 22mm 18mm 22mm;
        box-shadow: none;
        min-height: auto;
      }
      .body p { font-size: 9pt; line-height: 1.5; margin-bottom: 8px; }
      .footer {
        position: relative;
        bottom: auto;
        left: auto;
        right: auto;
        margin-top: 20px;
      }
    }

    @media (max-width: 800px) {
      body { padding: 10px; }
      .page { width: 100%; padding: 20px; min-height: auto; }
      .toolbar { position: static; justify-content: center; margin-bottom: 15px; flex-wrap: wrap; }
      .controls { padding: 15px; }
      .controls-row { flex-direction: column; align-items: stretch; }
      .name { font-size: 20pt; }
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <div class="lang-switch">
      <span class="lang-btn active">FR</span>
      <a href="lm-en-x7k9p2m4q8.html" class="lang-btn" onclick="switchLang(event)">EN</a>
    </div>
    <button class="btn-reset" onclick="resetTemplate()">Réinitialiser</button>
    <button class="btn-save" onclick="window.print()">Sauvegarder PDF</button>
  </div>

  <div class="controls">
    <div class="controls-row">
      <label>Profil</label>
      <div class="profile-buttons">
        <button class="profile-btn active" onclick="setProfile('general')">Général</button>
        <button class="profile-btn" onclick="setProfile('marketing')">Marketing</button>
        <button class="profile-btn" onclick="setProfile('event')">Événementiel</button>
        <button class="profile-btn" onclick="setProfile('hospitality')">Hôtellerie luxe</button>
        <button class="profile-btn" onclick="setProfile('communication')">Communication</button>
        <button class="profile-btn" onclick="setProfile('audiovisual')">Audiovisuel</button>
      </div>
    </div>
    <div class="controls-row">
      <label>Entreprise</label>
      <input type="text" id="companyName" placeholder="Optionnel – Ex: Paperjam" oninput="updateCompany()">
    </div>
    <div class="controls-row">
      <label>Objet</label>
      <input type="text" id="subjectInput" placeholder="Ex: Chef de projet marketing" oninput="updateSubject()">
    </div>
  </div>

  <div class="page">
    <p class="date" id="currentDate"></p>

    <header class="header">
      <h1 class="name">LEA SEVENIG</h1>
      <p class="contact-info">Paris, France · +33 6 64 32 20 24 · leasevenig13@icloud.com</p>
      <p class="contact-info" style="margin-top: 4px;">
        <a href="https://leasevenig.cv" style="font-weight: 500;">leasevenig.cv</a>
      </p>
    </header>

    <div class="subject">
      <span class="subject-label">Objet</span>
      <p><span id="subjectDisplay">Candidature</span><span id="companyDisplay"></span></p>
    </div>

    <p class="salutation">Madame, Monsieur,</p>

    <div class="body" id="letterBody" contenteditable="true"></div>

    <div class="closing" contenteditable="true">
      <p>Je serais ravie d'échanger avec vous lors d'un entretien afin de vous présenter plus en détail mon parcours et ma motivation.</p>
      <p>Je vous remercie pour l'attention portée à ma candidature et vous prie d'agréer, Madame, Monsieur, l'expression de mes salutations distinguées.</p>
      <p class="signature">Lea Sevenig</p>
    </div>

    <footer class="footer">
      <p>Portfolio : <a href="https://leasevenig.cv">leasevenig.cv</a></p>
    </footer>
  </div>

  <!-- Floating format toolbar -->
  <div class="format-toolbar" id="formatToolbar">
    <button class="fmt-bold" onmousedown="formatText(event, 'bold')" title="Gras">B</button>
    <button class="fmt-italic" onmousedown="formatText(event, 'italic')" title="Italique">I</button>
    <button class="fmt-underline" onmousedown="formatText(event, 'underline')" title="Souligné">U</button>
  </div>

  <!-- Toast notification -->
  <div class="toast" id="toast">Sauvegardé</div>

  <script>
    const profiles = {
      general: {
        subject: "Candidature",
        body: `<p>Trois langues maternelles, un resto éphémère monté de zéro, un master en audiovisuel et 18 mois à gérer le marketing de cinq adresses parisiennes en même temps — c'est le résumé rapide. Voici le détail.</p>

<p>J'ai commencé par un Bachelor en management de la restauration à l'Institut Lyfe, à Lyon. Pas un cursus théorique : on était en cuisine, en salle, face aux clients. C'est là que j'ai compris comment fonctionne un business de l'intérieur — les marges, le flux, l'expérience qu'on vend sans la nommer.</p>

<p>En 2022, avec deux associés, j'ai lancé Focacc' — un restaurant éphémère de focaccias à Lyon, six mois d'exploitation. J'ai tout porté côté marque : le nom, l'identité visuelle, la stratégie Instagram qui nous a amenés à 1 200 abonnés en trois semaines. On a fini avec un taux de remplissage de 85 % sur les deux derniers mois. Ce projet m'a appris une chose essentielle : savoir exécuter vite, mesurer, ajuster.</p>

<p>Ensuite, j'ai intégré l'EFAP Paris pour un Master en communication et production audiovisuelle. En parallèle, j'ai travaillé sur la masterclass "Court ou Crève" avec le youtubeur Ludovic — vidéo virale, lancement Instagram, création du site. Un projet qui m'a obligée à jongler entre production, planning serré et audience exigeante.</p>

<p>À la sortie du master, j'ai rejoint le groupe Nasther comme responsable communication, graphiste et web designer. Cinq établissements parisiens, chacun avec son positionnement. Je gérais tout : charte graphique, réseaux sociaux, campagnes print, refonte des sites web. Le plus formateur, c'est la capacité à passer d'un univers de marque à un autre dans la même journée.</p>

<p>Je suis luxembourgeoise — je parle couramment luxembourgeois, français, allemand et anglais. Je maîtrise la suite Adobe, Figma, Canva, et je suis à l'aise avec les outils analytics et CMS courants.</p>

<p>Ce que je cherche maintenant : une équipe où je peux apporter cette double casquette stratégie + exécution, et continuer à progresser sur des projets ambitieux.</p>`
      },
      marketing: {
        subject: "Candidature - Marketing",
        body: `<p>Le marketing, pour moi, ça commence sur le terrain. Avant de penser funnels ou KPIs, j'ai d'abord appris à observer ce qui fait revenir un client — ou pas. C'est cette approche concrète que j'apporte aujourd'hui.</p>

<p>Mon parcours a démarré à l'Institut Lyfe, à Lyon, avec un Bachelor en management de la restauration internationale. Trois ans à comprendre les mécaniques business de l'intérieur — pricing, positionnement, parcours client. Pas depuis un slide deck : depuis une cuisine, une salle, un comptoir.</p>

<p>En 2022, j'ai cofondé Focacc', un restaurant éphémère à Lyon. Six mois, de la création du concept à la fermeture. J'ai piloté toute la partie acquisition : identité de marque, stratégie réseaux sociaux, partenariats locaux. Résultat : 1 200 abonnés Instagram en trois semaines, taux de remplissage à 85 % sur la fin. Ce genre de contrainte — budget limité, temps compté — c'est le meilleur apprentissage marketing qui existe.</p>

<p>J'ai ensuite complété un Master en communication et production audiovisuelle à l'EFAP Paris. Un cursus qui m'a donné les outils techniques côté contenu : montage, DA, storytelling visuel. Pas juste la théorie — la capacité à produire.</p>

<p>Chez Nasther, pendant un an et demi, j'ai géré le marketing de cinq établissements parisiens. Concrètement : définition des axes de communication par marque, community management, création de tous les supports print et digitaux, suivi des performances, coordination avec les équipes terrain. Le défi quotidien, c'était de maintenir une cohérence de marque tout en adaptant le discours à des cibles très différentes — d'un bistrot à un bar à cocktails haut de gamme.</p>

<p>Aujourd'hui, je veux rejoindre une structure où le marketing a un vrai impact mesurable. Mon profil mêle vision stratégique et capacité d'exécution rapide — et c'est exactement cette combinaison qui me permet de faire avancer les projets.</p>`
      },
      event: {
        subject: "Candidature - Événementiel",
        body: `<p>Mon premier vrai événement, c'était un restaurant éphémère de 40 couverts à Lyon. Pas un stage d'observation — j'ai tout monté : le concept, le lieu, l'équipe, la comm'. Six mois d'exploitation, de l'ouverture à la fermeture. C'est ce type de terrain qui m'a formée à l'événementiel.</p>

<p>Ce projet, Focacc', je l'ai cofondé en 2022 pendant mon Bachelor à l'Institut Lyfe. J'y ai appris tout ce qu'un cours ne peut pas enseigner : négocier un bail précaire, gérer les imprévus fournisseurs, adapter le concept en cours de route quand les chiffres ne suivent pas. Le soir de l'ouverture, on avait 15 réservations. Le dernier mois, on refusait du monde.</p>

<p>Ensuite, j'ai travaillé un an pour La Dimanche, l'une des soirées LGBTQ+ les plus connues de Paris. J'étais en charge de la logistique bar : commandes, gestion des stocks, optimisation des flux en soirée. Des événements à 800-1 000 personnes, avec des pics d'affluence à gérer en temps réel. Ça forge le sang-froid.</p>

<p>En parallèle de mon Master à l'EFAP, j'ai collaboré sur la masterclass "Court ou Crève" avec le youtubeur Ludovic. Production de la vidéo principale, lancement du compte Instagram, création du site web. Un format événementiel digital — avec les mêmes exigences de deadline, de coordination d'équipe et de résultat.</p>

<p>Chez Nasther, j'ai accompagné de nombreux événements liés aux cinq établissements du groupe : soirées de lancement, collaborations marques, événements privés. Mon rôle : la coordination entre les équipes, la production de tous les supports de communication, le suivi opérationnel le jour J.</p>

<p>Ce que je sais faire : transformer un concept en expérience concrète, dans les délais, dans le budget, sans que ça se voie quand ça coince. C'est ce savoir-faire que j'aimerais mettre au service de vos projets événementiels.</p>`
      },
      hospitality: {
        subject: "Candidature - Hôtellerie de luxe",
        body: `<p>J'ai grandi au Luxembourg, entre trois langues et trois cultures. Cette habitude de naviguer entre les codes — savoir quand être formelle, quand être chaleureuse, quand simplement écouter — c'est exactement ce que demande l'hôtellerie haut de gamme.</p>

<p>Ma formation à l'Institut Lyfe, à Lyon, était centrée sur le management de la restauration internationale. Trois ans immergée dans les standards de service, la gestion d'établissements, l'attention au détail qui fait la différence entre un bon repas et une expérience mémorable. C'est là que j'ai développé cette sensibilité au luxe — pas le luxe ostentatoire, celui du geste juste au bon moment.</p>

<p>Avec Focacc', le restaurant éphémère que j'ai cofondé à Lyon, j'ai compris l'importance de l'image perçue. On vendait des focaccias, mais ce que les clients achetaient, c'était l'ambiance, le soin apporté à chaque détail — de la typographie du menu au packaging. Quand on a un budget limité, on apprend à créer de la valeur perçue autrement. Cette discipline me suit partout.</p>

<p>Mon Master en communication et production audiovisuelle à l'EFAP m'a donné les outils pour traduire une identité de marque en images, en mots, en expérience digitale cohérente. Tout ce qui fait qu'un client découvre un hôtel en ligne et a déjà envie d'y être.</p>

<p>Chez Nasther, j'ai piloté le marketing de cinq adresses parisiennes — dont certaines positionnées haut de gamme. Création de l'univers visuel, gestion des réseaux sociaux avec une ligne éditoriale soignée, conception des supports print. Le défi : maintenir un niveau d'exigence constant sur chaque point de contact avec le client.</p>

<p>Je parle luxembourgeois, français, allemand et anglais — couramment. C'est un atout concret pour accueillir une clientèle internationale et adapter la communication aux différents marchés. J'aimerais mettre cette combinaison — sens du service, culture visuelle, multilinguisme — au service d'un établissement d'exception.</p>`
      },
      communication: {
        subject: "Candidature - Communication",
        body: `<p>Une marque qui communique bien, ça ne se voit pas. Tout semble naturel, évident, fluide. C'est quand ça ne fonctionne pas qu'on remarque la communication. Mon travail, c'est de faire en sorte qu'on ne la remarque jamais — qu'elle porte le message sans effort apparent.</p>

<p>J'ai étudié la communication par deux chemins. D'abord par le terrain : un Bachelor en management de la restauration à l'Institut Lyfe, où j'ai vu comment le discours d'un établissement influence directement la perception client. Puis par la technique : un Master en communication et production audiovisuelle à l'EFAP Paris — stratégie éditoriale, DA, production de contenus, pilotage de projets.</p>

<p>Entre les deux, j'ai cofondé Focacc' à Lyon. Un restaurant éphémère où j'ai construit toute la communication de zéro : naming, identité visuelle, ligne éditoriale Instagram, supports print. Avec un budget quasi nul, chaque choix de mot, chaque photo comptait. On a atteint 1 200 abonnés en trois semaines — preuve qu'un message clair et authentique suffit quand il est bien calibré.</p>

<p>La masterclass "Court ou Crève", créée avec le youtubeur Ludovic, m'a confrontée à un autre registre : la communication digitale grand public. Vidéo virale, gestion de communauté, site web — le tout avec des délais serrés et une audience qui pardonne peu les faux pas.</p>

<p>Chez Nasther, j'étais responsable communication pour cinq établissements. Pas cinq déclinaisons du même message — cinq identités distinctes, cinq tons, cinq audiences. Je gérais la stratégie de contenu, le community management, les supports graphiques, les sites web. Ce qui m'a le plus appris : arbitrer entre ce que la marque veut dire et ce que le public a besoin d'entendre.</p>

<p>Je cherche une structure qui considère la communication comme un levier stratégique, pas comme un poste de dépense. C'est dans ce contexte que je donne le meilleur.</p>`
      },
      audiovisual: {
        subject: "Candidature - Audiovisuel",
        body: `<p>Je fais des images depuis que j'ai un ordinateur. D'abord par curiosité, puis par formation, aujourd'hui par métier. Ce qui me distingue d'un pur profil créatif, c'est que je comprends pourquoi on produit — pas seulement comment.</p>

<p>Mon Bachelor à l'Institut Lyfe m'a donné une base business solide : comprendre un marché, un positionnement, une cible. Mon Master en communication et production audiovisuelle à l'EFAP a ajouté la couche technique : réalisation, montage, motion design, direction artistique, gestion de production.</p>

<p>Le projet qui a tout connecté, c'est la masterclass "Court ou Crève" avec le youtubeur Ludovic. J'ai co-produit la vidéo principale — du script au montage final. J'ai aussi lancé et géré le compte Instagram du projet et conçu le site web. C'était mon premier vrai projet audiovisuel de bout en bout, avec une audience réelle et des objectifs chiffrés de visibilité.</p>

<p>Chez Nasther, j'ai été responsable de toute la production visuelle pour cinq établissements : shooting photo, création graphique (menus, affiches, réseaux sociaux), conception des sites web, et quelques projets vidéo courts pour les réseaux. Je travaillais seule sur ces sujets — ce qui veut dire que je gérais tout, du brief à la livraison, en passant par les retours et les ajustements.</p>

<p>En freelance, j'accompagne aussi des restaurateurs sur leur identité visuelle : logos, chartes graphiques, templates réseaux sociaux, suivi de projets photo et vidéo. Des missions où il faut comprendre vite l'univers du client et produire des supports qui lui ressemblent — pas un template générique.</p>

<p>Mon environnement technique : Premiere Pro, After Effects, Photoshop, Illustrator, InDesign, Lightroom, Figma, Canva, Webflow, WordPress. Je suis à l'aise sur toute la chaîne, de la captation au livrable final.</p>

<p>Ce que je cherche : intégrer une équipe où la production audiovisuelle et visuelle a une vraie place stratégique. Où on ne fait pas juste du contenu pour remplir un feed, mais pour raconter quelque chose.</p>`
      }
    };

    let currentProfile = 'general';
    let saveTimeout = null;

    // --- LocalStorage ---
    function getStorageKey(profile) {
      return `lm_edited_fr_${profile}`;
    }

    function getClosingKey(profile) {
      return `lm_edited_fr_closing_${profile}`;
    }

    function saveToStorage() {
      clearTimeout(saveTimeout);
      saveTimeout = setTimeout(() => {
        const bodyHtml = document.getElementById('letterBody').innerHTML;
        const closingHtml = document.querySelector('.closing').innerHTML;
        localStorage.setItem(getStorageKey(currentProfile), bodyHtml);
        localStorage.setItem(getClosingKey(currentProfile), closingHtml);
        showToast();
      }, 1000);
    }

    function showToast() {
      const toast = document.getElementById('toast');
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 1500);
    }

    function resetTemplate() {
      if (!confirm('Réinitialiser le texte ? Les modifications seront perdues.')) return;
      localStorage.removeItem(getStorageKey(currentProfile));
      localStorage.removeItem(getClosingKey(currentProfile));
      document.getElementById('letterBody').innerHTML = profiles[currentProfile].body;
      document.querySelector('.closing').innerHTML = getDefaultClosing();
      showToast();
    }

    function getDefaultClosing() {
      return `<p>Je serais ravie d'échanger avec vous lors d'un entretien afin de vous présenter plus en détail mon parcours et ma motivation.</p>
      <p>Je vous remercie pour l'attention portée à ma candidature et vous prie d'agréer, Madame, Monsieur, l'expression de mes salutations distinguées.</p>
      <p class="signature">Lea Sevenig</p>`;
    }

    // --- Profile switching ---
    function setProfile(profile) {
      currentProfile = profile;
      document.querySelectorAll('.profile-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');

      const p = profiles[profile];
      document.getElementById('subjectInput').value = p.subject;
      document.getElementById('subjectDisplay').textContent = p.subject;

      // Load from localStorage or fallback to template
      const savedBody = localStorage.getItem(getStorageKey(profile));
      const savedClosing = localStorage.getItem(getClosingKey(profile));
      document.getElementById('letterBody').innerHTML = savedBody || p.body;
      if (savedClosing) {
        document.querySelector('.closing').innerHTML = savedClosing;
      } else {
        document.querySelector('.closing').innerHTML = getDefaultClosing();
      }
    }

    function updateSubject() {
      const subject = document.getElementById('subjectInput').value.trim();
      document.getElementById('subjectDisplay').textContent = subject || profiles[currentProfile].subject;
    }

    function updateCompany() {
      const company = document.getElementById('companyName').value.trim();
      document.getElementById('companyDisplay').textContent = company ? ` - ${company}` : '';
    }

    function updateDate() {
      const months = ['janvier', 'février', 'mars', 'avril', 'mai', 'juin', 'juillet', 'août', 'septembre', 'octobre', 'novembre', 'décembre'];
      const now = new Date();
      document.getElementById('currentDate').textContent = `Paris, le ${now.getDate()} ${months[now.getMonth()]} ${now.getFullYear()}`;
    }

    // --- Paste handler: plain text only ---
    document.addEventListener('paste', function(e) {
      const target = e.target.closest('[contenteditable="true"]');
      if (!target) return;
      e.preventDefault();
      const text = e.clipboardData.getData('text/plain');
      document.execCommand('insertText', false, text);
    });

    // --- Auto-save on input ---
    document.addEventListener('input', function(e) {
      if (e.target.closest('[contenteditable="true"]')) {
        saveToStorage();
      }
    });

    // --- Floating format toolbar ---
    const toolbar = document.getElementById('formatToolbar');

    function formatText(e, command) {
      e.preventDefault();
      document.execCommand(command, false, null);
      updateToolbarState();
    }

    function updateToolbarState() {
      toolbar.querySelector('.fmt-bold').classList.toggle('active', document.queryCommandState('bold'));
      toolbar.querySelector('.fmt-italic').classList.toggle('active', document.queryCommandState('italic'));
      toolbar.querySelector('.fmt-underline').classList.toggle('active', document.queryCommandState('underline'));
    }

    function showToolbar() {
      const sel = window.getSelection();
      if (!sel.rangeCount || sel.isCollapsed) {
        toolbar.classList.remove('visible');
        return;
      }
      const range = sel.getRangeAt(0);
      const container = range.commonAncestorContainer;
      const editable = (container.nodeType === 1 ? container : container.parentElement).closest('[contenteditable="true"]');
      if (!editable) {
        toolbar.classList.remove('visible');
        return;
      }

      const rect = range.getBoundingClientRect();
      const toolbarWidth = 116;
      let left = rect.left + (rect.width / 2) - (toolbarWidth / 2) + window.scrollX;
      let top = rect.top - 48 + window.scrollY;

      // Keep within viewport
      left = Math.max(8, Math.min(left, window.innerWidth - toolbarWidth - 8));
      if (top < 8) top = rect.bottom + 8 + window.scrollY;

      toolbar.style.left = left + 'px';
      toolbar.style.top = top + 'px';
      toolbar.classList.add('visible');
      updateToolbarState();
    }

    document.addEventListener('selectionchange', showToolbar);
    document.addEventListener('mousedown', function(e) {
      if (!e.target.closest('.format-toolbar') && !e.target.closest('[contenteditable="true"]')) {
        toolbar.classList.remove('visible');
      }
    });

    // --- Init ---
    updateDate();
    const urlParams = new URLSearchParams(window.location.search);
    const paramCompany = urlParams.get('company');
    const paramSubject = urlParams.get('subject');
    const paramProfile = urlParams.get('profile');

    if (paramProfile && profiles[paramProfile]) {
      currentProfile = paramProfile;
      document.querySelectorAll('.profile-btn').forEach(btn => {
        btn.classList.toggle('active', btn.textContent.toLowerCase().includes(paramProfile.substring(0, 4)));
      });
      const savedBody = localStorage.getItem(getStorageKey(paramProfile));
      document.getElementById('letterBody').innerHTML = savedBody || profiles[paramProfile].body;
      const savedClosing = localStorage.getItem(getClosingKey(paramProfile));
      if (savedClosing) document.querySelector('.closing').innerHTML = savedClosing;
      document.getElementById('subjectInput').value = paramSubject || profiles[paramProfile].subject;
      document.getElementById('subjectDisplay').textContent = paramSubject || profiles[paramProfile].subject;
    } else {
      document.getElementById('subjectInput').value = paramSubject || profiles.general.subject;
      document.getElementById('subjectDisplay').textContent = paramSubject || profiles.general.subject;
      const savedBody = localStorage.getItem(getStorageKey('general'));
      document.getElementById('letterBody').innerHTML = savedBody || profiles.general.body;
      const savedClosing = localStorage.getItem(getClosingKey('general'));
      if (savedClosing) document.querySelector('.closing').innerHTML = savedClosing;
    }

    if (paramCompany) {
      document.getElementById('companyName').value = paramCompany;
      document.getElementById('companyDisplay').textContent = ` - ${paramCompany}`;
    }

    // Smooth language switch
    function switchLang(e) {
      e.preventDefault();
      const href = e.target.getAttribute('href');
      document.body.classList.add('fade-out');
      setTimeout(() => {
        window.location.href = href;
      }, 300);
    }
  </script>
</body>
</html>
